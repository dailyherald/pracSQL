# set directory
setwd("~/anaconda3/envs/notebook/MHMetrics/work/")
# load libraries
library(tidyverse)
#library('readxl')
library("RPostgreSQL")
options("scipen" = 10)
# connect to aranalysis (for pracSQL)
con <- dbConnect(drv, dbname = "aranalysis",
host = "localhost", port = 5432,
user = "tbroderick")
# execute query
sql <- "SELECT upper('hello);"
dbGetQuery(con, sql)
# connect to postgres (remembert to turn it on)
drv <- dbDriver("PostgreSQL")
# connect to aranalysis (for pracSQL)
con <- dbConnect(drv, dbname = "aranalysis",
host = "localhost", port = 5432,
user = "tbroderick")
# execute query
sql <- "SELECT upper('hello');"
dbGetQuery(con, sql)
# upper(), lower(), initcap
sql <- "SELECT lower('hello');"
dbGetQuery(con, sql)
# upper(), lower(), initcap
sql <- "SELECT initcap('hello');"
dbGetQuery(con, sql)
# get info about a string
sql <- "SELECT char_length(' Pat ");
# get info about a string
sql <- "SELECT char_length(' Pat ');"
dbGetQuery(con, sql)
# in R
toupper('hello')
tolower('HELLO')
toproper('hello')
capitalize('hello')
?tolower
paste(toupper(substring(s, 1, 1)), substring(s, 2),
sep = "", collapse = " ")
simpleCap <- function(x) {
s <- strsplit(x, " ")[[1]]
paste(toupper(substring(s, 1, 1)),
substring(s, 2),sep = "", collapse = " ")
}
simpleCap('hello')
# in R
length((' Pat ')
# in R
length(' Pat ')
# in R
str_length(' Pat ')
# find position of a character
sql <- "SELECT position(', ' in 'Tan, Bella');"
dbGetQuery(con, sql)
# in R
str_locate(', ', 'Tan, Bella')
# in R
str_locate_all(pattern =', ','Tan, Bella')
# get length of a string while triming spaces
sql <- "SELECT char_length(trim(' Pat '));"
dbGetQuery(con, sql)
# in R
str_length(trim(' Pat '))
# in R
str_length(trimws(' Pat '))
# in R
str_length(str_trim(' Pat '))
str_title('hello')
str_to_title('hello')
# in R
str_to_lower('hello')
str_to_upper('HELLO')
str_to_title('hello')
# get length of a string while triming spaces
sql <- "SELECT trim('s' from 'socks');"
dbGetQuery(con, sql)
str_remove('s','socks')
str_remove('socks','s')
sql <- "SELECT ltrim('s' from 'socks');"
dbGetQuery(con, sql)
sql <- "SELECT ltrim('socks','s');"
dbGetQuery(con, sql)
# in R
?str_remove
str_remove('socks',str_locate('s'))
str_sub('socks',1,2)
str_sub('socks',2,5)
# extracting characters
sql <- "SELECT left('708-555-1212',3);"
dbGetQuery(con, sql)
sql <- "SELECT right('708-555-1212',8);"
dbGetQuery(con, sql)
# in r
str_sub('708-555-1212',1,3)
str_sub('708-555-1212',-8)
str_remove('socks','^s')
str_remove('socks','$s') # beginning of a word
str_remove('socks','s$') # end of a word
# replace items in a string
sql <- "SELECT replace('bat','b','c');"
dbGetQuery(con, sql)
# In R
str_replace("bat","b","c")
setwd("~/anaconda3/envs/pracSQL/Chapter_13_text")
# set directory
setwd("~/anaconda3/envs/pracSQL/Chapter_13_text")
# Any character one or more times
sql <- "SELECT substring('The game starts at 7 p.m. on May 2, 2019.' from '.+');"
dbGetQuery(con, sql)
# One or two digits followed by a space and p.m.
sql <- "SELECT substring('The game starts at 7 p.m. on May 2, 2019.' from '\d{1,2} (?:a.m.|p.m.)');"
dbGetQuery(con, sql)
# One or two digits followed by a space and p.m.
sql <- "SELECT substring('The game starts at 7 p.m. on May 2, 2019.' from '\d{1,2} (?:a.m.|p.m.)');"
dbGetQuery(con, sql)
# One or more word characters at the start
sql <- "SELECT substring('The game starts at 7 p.m. on May 2, 2019.' from '^\w+');"
dbGetQuery(con, sql)
# Any character one or more times
sql <- "SELECT substring('The game starts at 7 p.m. on May 2, 2019.' from '.+');"
dbGetQuery(con, sql)
# One or two digits followed by a space and p.m.
sql <- "SELECT substring('The game starts at 7 p.m. on May 2, 2019.' from '\d{1,2} (?:a.m.|p.m.)');"
dbGetQuery(con, sql)
# One or two digits followed by a space and p.m.
sql <- "SELECT substring('The game starts at 7 p.m. on May 2, 2019.' from '/d{1,2} (?:a.m.|p.m.)');"
dbGetQuery(con, sql)
# One or two digits followed by a space and p.m.
sql <- "SELECT substring('The game starts at 7 p.m. on May 2, 2019.' from '\\d{1,2} (?:a.m.|p.m.)');"
dbGetQuery(con, sql)
# One or more word characters at the start
sql <- "SELECT substring('The game starts at 7 p.m. on May 2, 2019.' from '^\\w+');"
dbGetQuery(con, sql)
# One or more word characters followed by any character at the end.
sql <- "SELECT substring('The game starts at 7 p.m. on May 2, 2019.' from '\\w+.$');"
dbGetQuery(con, sql)
# The words May or June
sql <- "SELECT substring('The game starts at 7 p.m. on May 2, 2019.' from 'May|June');"
# Four digits
sql <- "SELECT substring('The game starts at 7 p.m. on May 2, 2019.' from '\d{4}');"
# The words May or June
sql <- "SELECT substring('The game starts at 7 p.m. on May 2, 2019.' from 'May|June');"
dbGetQuery(con, sql)
# Four digits
sql <- "SELECT substring('The game starts at 7 p.m. on May 2, 2019.' from '\\d{4}');"
dbGetQuery(con, sql)
# May followed by a space, digit, comma, space, and four digits.
sql <- "SELECT substring('The game starts at 7 p.m. on May 2, 2019.' from 'May \\d, \\d{4}');"
dbGetQuery(con, sql)
# Any character one or more times
sql <- "SELECT substring('The game starts at 7 p.m. on May 2, 2019.' from '.+');"
dbGetQuery(con, sql)
# in R
str_sub('The game starts at 7 p.m. on May 2, 2019.','.+')
# in R
str_match('The game starts at 7 p.m. on May 2, 2019.','.+')
str_match('The game starts at 7 p.m. on May 2, 2019.','\d{1,2} (?:a.m.|p.m.)')
str_match('The game starts at 7 p.m. on May 2, 2019.','\\d{1,2} (?:a.m.|p.m.)')
str_match('The game starts at 7 p.m. on May 2, 2019.' , '^\\w+')
str_match('The game starts at 7 p.m. on May 2, 2019.' , '\\w+.$')
str_match('The game starts at 7 p.m. on May 2, 2019.' , 'May|June')
str_match('The game starts at 7 p.m. on May 2, 2019.' , '\\d{4}')
str_match('The game starts at 7 p.m. on May 2, 2019.' , 'May \\d, \\d{4}')
